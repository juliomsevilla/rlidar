<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 R y la información LiDAR forestal | Tratamiento de datos LiDAR forestales mediante R</title>
  <meta name="description" content="En este libro haremos una introducción al tratamiento de datos LiDAR forestales mediante R" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="2 R y la información LiDAR forestal | Tratamiento de datos LiDAR forestales mediante R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="En este libro haremos una introducción al tratamiento de datos LiDAR forestales mediante R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 R y la información LiDAR forestal | Tratamiento de datos LiDAR forestales mediante R" />
  
  <meta name="twitter:description" content="En este libro haremos una introducción al tratamiento de datos LiDAR forestales mediante R" />
  

<meta name="author" content="Julio M. Sevilla" />


<meta name="date" content="2021-10-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="introducción-al-lenguaje-r.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introducción</a></li>
<li class="chapter" data-level="1" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html"><i class="fa fa-check"></i><b>1</b> Introducción al lenguaje R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#introducción-al-lenguaje-r-1"><i class="fa fa-check"></i><b>1.1</b> Introducción al lenguaje R</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#que-es-r"><i class="fa fa-check"></i><b>1.1.1</b> ¿Que es R?</a></li>
<li class="chapter" data-level="1.1.2" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#por-qué-usar-r"><i class="fa fa-check"></i><b>1.1.2</b> ¿Por qué usar R?</a></li>
<li class="chapter" data-level="1.1.3" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#recursos-sobre-r"><i class="fa fa-check"></i><b>1.1.3</b> Recursos sobre R</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#instalación-de-r-rstudio-y-librerias"><i class="fa fa-check"></i><b>1.2</b> Instalación de R, RStudio y librerias</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#instalación-de-r"><i class="fa fa-check"></i><b>1.2.1</b> Instalación de R</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#actualización-de-r"><i class="fa fa-check"></i><b>1.3</b> Actualización de R</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#el-sistema-r"><i class="fa fa-check"></i><b>1.3.1</b> El Sistema R</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#gestión-de-directorios-archivos-y-versiones"><i class="fa fa-check"></i><b>1.4</b> Gestión de directorios, archivos y versiones</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#gestión-de-directorios"><i class="fa fa-check"></i><b>1.4.1</b> Gestión de directorios</a></li>
<li class="chapter" data-level="1.4.2" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#manejo-de-archivos"><i class="fa fa-check"></i><b>1.4.2</b> Manejo de archivos</a></li>
<li class="chapter" data-level="1.4.3" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#carga-de-datos-usando-el-buscador"><i class="fa fa-check"></i><b>1.4.3</b> Carga de datos usando el buscador</a></li>
<li class="chapter" data-level="1.4.4" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#limpieza-de-la-memoria-en-r"><i class="fa fa-check"></i><b>1.4.4</b> Limpieza de la memoria en <code>R</code></a></li>
<li class="chapter" data-level="1.4.5" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#control-de-versiones"><i class="fa fa-check"></i><b>1.4.5</b> Control de versiones</a></li>
<li class="chapter" data-level="1.4.6" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#buenas-prácticas-en-la-gestión-de-un-proyecto"><i class="fa fa-check"></i><b>1.4.6</b> Buenas prácticas en la gestión de un proyecto</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#manejo-de-objetos-en-r"><i class="fa fa-check"></i><b>1.5</b> Manejo de objetos en R</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#r-como-calculadora"><i class="fa fa-check"></i><b>1.5.1</b> R como calculadora</a></li>
<li class="chapter" data-level="1.5.2" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#manejo-de-variables"><i class="fa fa-check"></i><b>1.5.2</b> Manejo de variables</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#manejo-de-datos-en-r"><i class="fa fa-check"></i><b>1.6</b> Manejo de datos en R</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#tipos-de-datos"><i class="fa fa-check"></i><b>1.6.1</b> Tipos de datos</a></li>
<li class="chapter" data-level="1.6.2" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#valores-perdidos-y-nulos"><i class="fa fa-check"></i><b>1.6.2</b> Valores perdidos y nulos</a></li>
<li class="chapter" data-level="1.6.3" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#registros-duplicados"><i class="fa fa-check"></i><b>1.6.3</b> Registros duplicados</a></li>
<li class="chapter" data-level="1.6.4" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#reescalado"><i class="fa fa-check"></i><b>1.6.4</b> Reescalado</a></li>
<li class="chapter" data-level="1.6.5" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#normalizado-y-estandarizado"><i class="fa fa-check"></i><b>1.6.5</b> Normalizado y estandarizado</a></li>
<li class="chapter" data-level="1.6.6" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#categorizar-los-datos"><i class="fa fa-check"></i><b>1.6.6</b> Categorizar los datos</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#profundizando-en-el-data.frame"><i class="fa fa-check"></i><b>1.7</b> Profundizando en el <code>data.frame</code></a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#introducción-1"><i class="fa fa-check"></i><b>1.7.1</b> Introducción</a></li>
<li class="chapter" data-level="1.7.2" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#visualizar-tablas"><i class="fa fa-check"></i><b>1.7.2</b> Visualizar tablas</a></li>
<li class="chapter" data-level="1.7.3" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#extracción-de-datos-en-nuevos-data.frame"><i class="fa fa-check"></i><b>1.7.3</b> Extracción de datos en nuevos <code>data.frame</code></a></li>
<li class="chapter" data-level="1.7.4" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#gestionar-los-data.frame"><i class="fa fa-check"></i><b>1.7.4</b> Gestionar los <code>data.frame</code></a></li>
<li class="chapter" data-level="1.7.5" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#la-libreria-dplyr"><i class="fa fa-check"></i><b>1.7.5</b> La libreria <code>dplyr</code></a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#estructuras-de-control"><i class="fa fa-check"></i><b>1.8</b> Estructuras de control</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#introducción-2"><i class="fa fa-check"></i><b>1.8.1</b> Introducción</a></li>
<li class="chapter" data-level="1.8.2" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#while"><i class="fa fa-check"></i><b>1.8.2</b> <code>while</code></a></li>
<li class="chapter" data-level="1.8.3" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#for"><i class="fa fa-check"></i><b>1.8.3</b> <code>for</code></a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#los-gráficos-en-r"><i class="fa fa-check"></i><b>1.9</b> Los gráficos en R</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#ggplot2"><i class="fa fa-check"></i><b>1.9.1</b> ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#las-funciones-en-r"><i class="fa fa-check"></i><b>1.10</b> Las funciones en R</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#estructura-de-una-función"><i class="fa fa-check"></i><b>1.10.1</b> Estructura de una función</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#publicación-de-resultados"><i class="fa fa-check"></i><b>1.11</b> Publicación de resultados</a>
<ul>
<li class="chapter" data-level="1.11.1" data-path="introducción-al-lenguaje-r.html"><a href="introducción-al-lenguaje-r.html#la-escritura-con-markdown"><i class="fa fa-check"></i><b>1.11.1</b> La escritura con Markdown</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-y-la-información-lidar-forestal.html"><a href="r-y-la-información-lidar-forestal.html"><i class="fa fa-check"></i><b>2</b> R y la información LiDAR forestal</a>
<ul>
<li class="chapter" data-level="2.1" data-path="r-y-la-información-lidar-forestal.html"><a href="r-y-la-información-lidar-forestal.html#la-teledetección-y-la-tecnología-lidar"><i class="fa fa-check"></i><b>2.1</b> La teledetección y la tecnología LiDAR</a></li>
<li class="chapter" data-level="2.2" data-path="r-y-la-información-lidar-forestal.html"><a href="r-y-la-información-lidar-forestal.html#preparación-del-entorno-de-trabajo"><i class="fa fa-check"></i><b>2.2</b> Preparación del entorno de trabajo</a></li>
<li class="chapter" data-level="2.3" data-path="r-y-la-información-lidar-forestal.html"><a href="r-y-la-información-lidar-forestal.html#preparación-de-los-datos"><i class="fa fa-check"></i><b>2.3</b> Preparación de los datos</a></li>
<li class="chapter" data-level="2.4" data-path="r-y-la-información-lidar-forestal.html"><a href="r-y-la-información-lidar-forestal.html#análisis-de-los-datos"><i class="fa fa-check"></i><b>2.4</b> Análisis de los datos</a></li>
<li class="chapter" data-level="2.5" data-path="r-y-la-información-lidar-forestal.html"><a href="r-y-la-información-lidar-forestal.html#modelo-digital-del-terreno"><i class="fa fa-check"></i><b>2.5</b> Modelo digital del terreno</a></li>
<li class="chapter" data-level="2.6" data-path="r-y-la-información-lidar-forestal.html"><a href="r-y-la-información-lidar-forestal.html#modelo-digital-de-las-elevaciones"><i class="fa fa-check"></i><b>2.6</b> Modelo digital de las elevaciones</a></li>
<li class="chapter" data-level="2.7" data-path="r-y-la-información-lidar-forestal.html"><a href="r-y-la-información-lidar-forestal.html#métodos-de-masa"><i class="fa fa-check"></i><b>2.7</b> Métodos de masa</a></li>
<li class="chapter" data-level="2.8" data-path="r-y-la-información-lidar-forestal.html"><a href="r-y-la-información-lidar-forestal.html#segmentación-de-árboles"><i class="fa fa-check"></i><b>2.8</b> Segmentación de árboles</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>3</b> Referencias</a></li>
<li class="divider"></li>
Ir a <a href="http://www.jsevilla.es/">JSEVILLA</a>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tratamiento de datos LiDAR forestales mediante R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r-y-la-información-lidar-forestal" class="section level1" number="2">
<h1><span class="header-section-number">2</span> R y la información LiDAR forestal</h1>
<div id="la-teledetección-y-la-tecnología-lidar" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> La teledetección y la tecnología LiDAR</h2>
<p>Entendemos por teledetección a toda aquella técnica que permite obtener información a distancia de objetos sin que exista un contacto material (por ejemplo una fotografía). Generalmente se aplica a objetos situados sobre la superficie terrestre y coloquialmente es sinónimo de información a partir de imágenes de satélite</p>
<ul>
<li>Teledetección pasiva: detectan radiación natural emitida o reflejada por el objeto o área circundante que está siendo observada. La luz solar reflejada es uno de los tipos de radiación más comunes medidos por esta clase de teledetección.</li>
</ul>
<p>Se necesita una fuente de energía, un objeto y un sensor teledetector. El primero “ilumina” el objetivo emitiendo una onda electromagnética (flujo de fotones) y el último mide la energía solar (es decir la radiación electromagnética) reflejada por el objetivo. Cuando la fuente de energía es el Sol, y el captador solo mide la radiación reflejada, se conoce como teledetección pasiva.</p>
<pre><code>![]([https://raw.githubusercontent.com/juliomsevilla/rlidar/main/images/pasiva.png)</code></pre>
<ul>
<li><p>Teledetección activa: emiten energía que les permite “escanear” objetos y áreas. El sistema mide la radiación reflejada del objetivo.</p>
<p><img src="%5B%5Bhttps://raw.githubusercontent.com/juliomsevilla/rlidar/main/images/activa.png" /></p></li>
<li><p>Radar. Teledetector activo que mide el tiempo que tarda una emisión en ir y volver de un punto, estableciendo así la localización, altura, velocidad y dirección de un objeto determinado.</p></li>
<li><p>LiDAR (Light Detection and Ranging o Laser Imaging Detection and Ranging). Dispositivo que permite determinar la distancia desde un emisor láser a un objeto o superficie utilizando un haz láser pulsado.</p></li>
</ul>
</div>
<div id="preparación-del-entorno-de-trabajo" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Preparación del entorno de trabajo</h2>
<p>A lo largo de este manual haremos uso de varias librerías de <code>R</code> relativas al tratamiento de datos espacial, con especial atención a la librería <code>lidR</code> que sera la herramienta de cabecera. Dado que muchas puede ser que ya estén instaladas en tu computadora, usaremos un pequeño código que permite distinguir si ya lo está y si no es así, procede a instalarla de forma transparente para ti.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="r-y-la-información-lidar-forestal.html#cb168-1" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;lidR&quot;</span>, <span class="st">&quot;sf&quot;</span>, <span class="st">&quot;rgdal&quot;</span>, <span class="st">&quot;dplyr&quot;</span>, <span class="st">&quot;skimr&quot;</span>, <span class="st">&quot;lmtest&quot;</span>)</span>
<span id="cb168-2"><a href="r-y-la-información-lidar-forestal.html#cb168-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-3"><a href="r-y-la-información-lidar-forestal.html#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Instalamos los paquetes que no estén instalados</span></span>
<span id="cb168-4"><a href="r-y-la-información-lidar-forestal.html#cb168-4" aria-hidden="true" tabindex="-1"></a>installed_packages <span class="ot">&lt;-</span> packages <span class="sc">%in%</span> <span class="fu">rownames</span>(<span class="fu">installed.packages</span>())</span>
<span id="cb168-5"><a href="r-y-la-información-lidar-forestal.html#cb168-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span>(installed_packages <span class="sc">==</span> <span class="cn">FALSE</span>)) {</span>
<span id="cb168-6"><a href="r-y-la-información-lidar-forestal.html#cb168-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(packages[<span class="sc">!</span>installed_packages])</span>
<span id="cb168-7"><a href="r-y-la-información-lidar-forestal.html#cb168-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb168-8"><a href="r-y-la-información-lidar-forestal.html#cb168-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-9"><a href="r-y-la-información-lidar-forestal.html#cb168-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargamos los paquetes</span></span>
<span id="cb168-10"><a href="r-y-la-información-lidar-forestal.html#cb168-10" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">lapply</span>(packages, library, <span class="at">character.only =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p>A continuación crearemos una estructura de carpetas, predefinida, de forma que el trabajo sea lo más sistemático posible. Con ellas creadas, fijamos el directorio de trabajo y procedemos a descargar y descomprimir los datos LiDAR, vectoriales, raster y tabulares de los que disponemos del trabajo de campo y del vuelo LiDAR:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="r-y-la-información-lidar-forestal.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">&quot;c:/curso_lidar/&quot;</span>, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb169-2"><a href="r-y-la-información-lidar-forestal.html#cb169-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-3"><a href="r-y-la-información-lidar-forestal.html#cb169-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-4"><a href="r-y-la-información-lidar-forestal.html#cb169-4" aria-hidden="true" tabindex="-1"></a>dir<span class="ot">&lt;-</span><span class="st">&quot;c:/curso_lidar/&quot;</span></span>
<span id="cb169-5"><a href="r-y-la-información-lidar-forestal.html#cb169-5" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(dir)</span>
<span id="cb169-6"><a href="r-y-la-información-lidar-forestal.html#cb169-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-7"><a href="r-y-la-información-lidar-forestal.html#cb169-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">&quot;./temp/&quot;</span>, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb169-8"><a href="r-y-la-información-lidar-forestal.html#cb169-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">&quot;./data/&quot;</span>, <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb169-9"><a href="r-y-la-información-lidar-forestal.html#cb169-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-10"><a href="r-y-la-información-lidar-forestal.html#cb169-10" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;./data/&quot;</span>)</span>
<span id="cb169-11"><a href="r-y-la-información-lidar-forestal.html#cb169-11" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">&quot;https://raw.githubusercontent.com/juliomsevilla/rlidar/main/data/lidar_data.zip&quot;</span>,</span>
<span id="cb169-12"><a href="r-y-la-información-lidar-forestal.html#cb169-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">destfile =</span> <span class="fu">paste</span>(<span class="fu">getwd</span>(), <span class="st">&quot;/lidar_data.zip&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>), </span>
<span id="cb169-13"><a href="r-y-la-información-lidar-forestal.html#cb169-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">&quot;curl&quot;</span>, <span class="at">overwrite=</span><span class="cn">TRUE</span>)</span>
<span id="cb169-14"><a href="r-y-la-información-lidar-forestal.html#cb169-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-15"><a href="r-y-la-información-lidar-forestal.html#cb169-15" aria-hidden="true" tabindex="-1"></a><span class="fu">unzip</span>(<span class="fu">paste</span>(<span class="fu">getwd</span>(), <span class="st">&quot;/lidar_data.zip&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb169-16"><a href="r-y-la-información-lidar-forestal.html#cb169-16" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(dir)</span></code></pre></div>
</div>
<div id="preparación-de-los-datos" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Preparación de los datos</h2>
<p>Para comenzar, si analizamos los <em>tiles</em> LiDAR, estos no vienen proyectados, por lo que procederemos a ello. Para hacerlo de forma rápida y automática usaremos una estructura de control <code>for</code> de forma que si previamente hemos listado todos los ficheros LiDAR a reproyectar, abriremos cada uno de ellos con <code>readLAS()</code>se les asigne la proyección que realmente tienen y se guarden con ella en la carpeta <code>temp</code> con <code>writeLAS</code>.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="r-y-la-información-lidar-forestal.html#cb170-1" aria-hidden="true" tabindex="-1"></a>tiles <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="fu">paste</span>(dir, <span class="st">&quot;data/tiles/&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>), <span class="at">full.names=</span><span class="cn">TRUE</span>)</span>
<span id="cb170-2"><a href="r-y-la-información-lidar-forestal.html#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;./temp/&quot;</span>)</span>
<span id="cb170-3"><a href="r-y-la-información-lidar-forestal.html#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span>
<span id="cb170-4"><a href="r-y-la-información-lidar-forestal.html#cb170-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-5"><a href="r-y-la-información-lidar-forestal.html#cb170-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-6"><a href="r-y-la-información-lidar-forestal.html#cb170-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (file <span class="cf">in</span> tiles) {</span>
<span id="cb170-7"><a href="r-y-la-información-lidar-forestal.html#cb170-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb170-8"><a href="r-y-la-información-lidar-forestal.html#cb170-8" aria-hidden="true" tabindex="-1"></a>  las<span class="ot">&lt;-</span><span class="fu">readLAS</span>(file)</span>
<span id="cb170-9"><a href="r-y-la-información-lidar-forestal.html#cb170-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">epsg</span>(las) <span class="ot">&lt;-</span> <span class="dv">25830</span></span>
<span id="cb170-10"><a href="r-y-la-información-lidar-forestal.html#cb170-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">writeLAS</span>(las, <span class="fu">basename</span>(file))</span>
<span id="cb170-11"><a href="r-y-la-información-lidar-forestal.html#cb170-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(las)</span>
<span id="cb170-12"><a href="r-y-la-información-lidar-forestal.html#cb170-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb170-13"><a href="r-y-la-información-lidar-forestal.html#cb170-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-14"><a href="r-y-la-información-lidar-forestal.html#cb170-14" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(dir)</span></code></pre></div>
</div>
<div id="análisis-de-los-datos" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Análisis de los datos</h2>
<p>La librería <code>lidR</code>,para gestionar grandes cantidades de datos, usa un objeto <code>LAScatalog</code> de modo que el procesamiento de cada tesela LiDAR se hace de forma ordenada. El objeto <code>LAScatalog</code> en realidad contiene las referencias geográficas y cabeceras de los ficheros LiDAR que permite ubicar espacialmente y posteriormente aplicar la mayoría de las funciones de <code>lidR</code> como si se tratara de una sola nube de puntos cargada en la memoria de la computadora.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="r-y-la-información-lidar-forestal.html#cb171-1" aria-hidden="true" tabindex="-1"></a>ctg <span class="ot">&lt;-</span> <span class="fu">readLAScatalog</span>(<span class="st">&quot;./temp/&quot;</span>)</span>
<span id="cb171-2"><a href="r-y-la-información-lidar-forestal.html#cb171-2" aria-hidden="true" tabindex="-1"></a>ctg</span>
<span id="cb171-3"><a href="r-y-la-información-lidar-forestal.html#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ctg)</span></code></pre></div>
<p>Una vez creado el objeto <code>LAScatalog</code> procedemos a su validación y estudio con el comando <code>las_check</code>:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="r-y-la-información-lidar-forestal.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">las_check</span>(ctg)</span></code></pre></div>
<p>La clasificación de los puntos terrestres es un paso importante en el procesamiento de datos de nubes de puntos. La distinción entre puntos de suelo y no permite crear un modelo digital del terreno que posteriormente nos permita normalizar los puntos LiDAR, esto es, pasar de altitudes respecto a un determinado nivel de referencia a alturas o cotas respecto a un cero, que, evidentemente, si hablamos de árboles es lo que más nos puede interesar.</p>
<p>Los datos del ejemplo ya vienen clasificados, pero los volveremos a clasificar para demostrar como lo efectúa la librería <code>lidR</code>. En concreto, esta librería usa dos formas de clasificación: <code>pmf()</code> <span class="citation">(<a href="#ref-R-Zhang2003" role="doc-biblioref">K. Zhang et al. 2003</a>)</span> y <code>csf()</code> <span class="citation">(<a href="#ref-R-Zhang2016" role="doc-biblioref">W. Zhang et al. 2016</a>)</span>, cada uno con parámetros característicos que podremos modificar y es uno de los pasos más críticos y complejos del proceso.</p>
<p>Una vez que los puntos son clasificados, se asigna el valor de 2 al campo de clasificación del retorno, siguiendo las prescripciones que estandariza la Sociedad Americana de Fotogrametría y Teledetección (<a href="https://www.asprs.org/">ASPRS</a>) para los formatos LAS 1.1, 1.2, 1.3 y 1.4.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="r-y-la-información-lidar-forestal.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">opt_filter</span>(ctg) <span class="ot">&lt;-</span> <span class="st">&quot;-drop-scan-angle &#39;&gt;=91&#39;&quot;</span></span>
<span id="cb173-2"><a href="r-y-la-información-lidar-forestal.html#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="fu">opt_output_files</span>(ctg) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(dir,<span class="st">&quot;/temp/&quot;</span>, <span class="st">&quot;{*}_classified&quot;</span>)</span>
<span id="cb173-3"><a href="r-y-la-información-lidar-forestal.html#cb173-3" aria-hidden="true" tabindex="-1"></a>classified_ctg <span class="ot">&lt;-</span> <span class="fu">classify_ground</span>(ctg, <span class="fu">csf</span>())</span></code></pre></div>
</div>
<div id="modelo-digital-del-terreno" class="section level2" number="2.5">
<h2><span class="header-section-number">2.5</span> Modelo digital del terreno</h2>
<p>Con la nube de puntos clasificada, al menos en puntos de suelo y no, calcularemos el modelo digital del terreno que posteriormente nos permita normalizar la nube de puntos.</p>
<p>La librería <code>lidR</code>permite tres métodos de interpolación de los puntos del suelo con el comando <code>grid_terrain</code>: <code>tin</code> (red de triángulos irregulares), <code>knnidw</code> (distancia inversa ponderada) y <code>kriging</code>, de menor a mayor complejidad y uso de recursos en este orden.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<p>En nuestro caso, usamos <code>kriging</code> (<code>lidR</code> usa la librería <code>gstat</code> por si deseamos saber más sobre este método de interpolación probabilístico) porque los otros métodos no se pueden usar debido a los pocos puntos de suelo que tenemos. Si usamos <code>algorithm =tin()</code> por ejemplo, observaremos a un error del tipo <code>convexhull</code> debido a que los puntos de suelo con los que contamos en muchos casos están muy separados físicamente.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="r-y-la-información-lidar-forestal.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">opt_output_files</span>(classified_ctg) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(dir,<span class="st">&quot;temp/&quot;</span>, <span class="st">&quot;{*}_dtm&quot;</span>)</span>
<span id="cb174-2"><a href="r-y-la-información-lidar-forestal.html#cb174-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-3"><a href="r-y-la-información-lidar-forestal.html#cb174-3" aria-hidden="true" tabindex="-1"></a>dtm <span class="ot">&lt;-</span> <span class="fu">grid_terrain</span>(classified_ctg, <span class="dv">1</span>,  <span class="at">algorithm =</span> <span class="fu">kriging</span>(<span class="at">k =</span> <span class="dv">40</span>), <span class="at">overwrite=</span><span class="cn">TRUE</span>)</span>
<span id="cb174-4"><a href="r-y-la-información-lidar-forestal.html#cb174-4" aria-hidden="true" tabindex="-1"></a>dtm</span>
<span id="cb174-5"><a href="r-y-la-información-lidar-forestal.html#cb174-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dtm)</span></code></pre></div>
</div>
<div id="modelo-digital-de-las-elevaciones" class="section level2" number="2.6">
<h2><span class="header-section-number">2.6</span> Modelo digital de las elevaciones</h2>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="r-y-la-información-lidar-forestal.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalizamos los datos y creamos el modelo digital de elevaciones normalizado</span></span>
<span id="cb175-2"><a href="r-y-la-información-lidar-forestal.html#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">opt_output_files</span>(classified_ctg) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(dir,<span class="st">&quot;/temp/&quot;</span>, <span class="st">&quot;{*}_norm&quot;</span>)</span>
<span id="cb175-3"><a href="r-y-la-información-lidar-forestal.html#cb175-3" aria-hidden="true" tabindex="-1"></a>ctg_norm <span class="ot">&lt;-</span> <span class="fu">normalize_height</span>(classified_ctg, dtm)</span>
<span id="cb175-4"><a href="r-y-la-información-lidar-forestal.html#cb175-4" aria-hidden="true" tabindex="-1"></a>ctg_norm</span>
<span id="cb175-5"><a href="r-y-la-información-lidar-forestal.html#cb175-5" aria-hidden="true" tabindex="-1"></a><span class="fu">las_check</span>(ctg_norm)</span>
<span id="cb175-6"><a href="r-y-la-información-lidar-forestal.html#cb175-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-7"><a href="r-y-la-información-lidar-forestal.html#cb175-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-8"><a href="r-y-la-información-lidar-forestal.html#cb175-8" aria-hidden="true" tabindex="-1"></a><span class="fu">opt_filter</span>(ctg_norm) <span class="ot">&lt;-</span> <span class="st">&quot;-drop_z_below 0&quot;</span> <span class="co"># Ignoramos los puntos con cota por debajo de cero</span></span>
<span id="cb175-9"><a href="r-y-la-información-lidar-forestal.html#cb175-9" aria-hidden="true" tabindex="-1"></a><span class="fu">opt_output_files</span>(ctg_norm) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(dir,<span class="st">&quot;/temp/&quot;</span>, <span class="st">&quot;{*}_mds&quot;</span>)</span>
<span id="cb175-10"><a href="r-y-la-información-lidar-forestal.html#cb175-10" aria-hidden="true" tabindex="-1"></a>mdv <span class="ot">&lt;-</span> <span class="fu">grid_canopy</span>(ctg_norm, <span class="dv">1</span>, <span class="fu">pitfree</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">subcircle =</span> <span class="fl">0.2</span>))</span>
<span id="cb175-11"><a href="r-y-la-información-lidar-forestal.html#cb175-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mdv)</span></code></pre></div>
</div>
<div id="métodos-de-masa" class="section level2" number="2.7">
<h2><span class="header-section-number">2.7</span> Métodos de masa</h2>
<p>La aplicación de la metodología de los métodos de masa consiste en relacionar unos lugares que conocemos a ciencia cierta, debido a que hemos procedido a medirlos in situ, relacionarlos con la nube de puntos en esos lugares y, sí existe una determinada relación (lineal o no), extrapolarla al resto de la nube de puntos de forma que podamos predecir el comportamiento de la masa forestal sin haberla evaluado desde el suelo. Es decir, se trata de una evaluación supervisada.</p>
<p>Por comodidad y en adelante, estos lugares que vamos a recortar de la nube de puntos los denominaremos parcelas (de muestreo) y huelga hablar de la importancia de conocer con precisión y exactitud la ubicación de los mismos para que los puntos LiDAR que estudiemos sean los que exactamente han caído sobre los árboles medidos.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="r-y-la-información-lidar-forestal.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">opt_filter</span>(ctg_norm) <span class="ot">&lt;-</span> <span class="st">&quot;-drop_z_below 0&quot;</span></span>
<span id="cb176-2"><a href="r-y-la-información-lidar-forestal.html#cb176-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-3"><a href="r-y-la-información-lidar-forestal.html#cb176-3" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;./data/parc.shp&quot;</span>)</span>
<span id="cb176-4"><a href="r-y-la-información-lidar-forestal.html#cb176-4" aria-hidden="true" tabindex="-1"></a>plots</span>
<span id="cb176-5"><a href="r-y-la-información-lidar-forestal.html#cb176-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(plots, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p>Para recortar estas parcelas de la nube de puntos podemos usar el comando <code>plot_metrics</code> (además guardaremos estos recortes para su uso futuro):</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="r-y-la-información-lidar-forestal.html#cb177-1" aria-hidden="true" tabindex="-1"></a>tiles_norm <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="fu">paste</span>(dir, <span class="st">&quot;temp/&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>), <span class="at">full.names =</span> <span class="cn">TRUE</span>, <span class="at">pattern =</span> <span class="st">&quot;(.*)norm.las$&quot;</span>)</span>
<span id="cb177-2"><a href="r-y-la-información-lidar-forestal.html#cb177-2" aria-hidden="true" tabindex="-1"></a>ctg_norm <span class="ot">&lt;-</span> <span class="fu">readLAScatalog</span>(tiles_norm)</span>
<span id="cb177-3"><a href="r-y-la-información-lidar-forestal.html#cb177-3" aria-hidden="true" tabindex="-1"></a>stats <span class="ot">&lt;-</span> <span class="fu">plot_metrics</span>(ctg_norm, .stdmetrics_z, plots, <span class="at">radius =</span> <span class="dv">9</span>)</span>
<span id="cb177-4"><a href="r-y-la-información-lidar-forestal.html#cb177-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(stats)</span></code></pre></div>
<p>Cargamos los datos medidos en las parcelas y se lo añadimos a los datos lidar. A continuación realizamos un análisis de correlación entre las variables de la nube de puntos y la futura variable dependiente (en este caso <code>vcc</code>).</p>
<p>Se define por correlación a la dirección y magnitud de la asociación entre dos variables cuantitativas, es decir que grado de relación hay entre ellas y si el aumento o disminución de una provoca el aumento o disminución de la otra.</p>
<p>El grado de correlación se mide mediante dos coeficientes: el coeficiente de correlación de Pearson y el coeficiente de correlación de Spearman, análogos en significado pero disimiles en su aplicación.</p>
<p>El coeficiente de correlación de Pearson es un coeficiente adimensional que va fluctúa entre -1 y +1, donde el primer valor indica la existencia de una asociación perfecta en sentido decreciente y el segundo en sentido creciente. Evidentemente, el valor cero, indica la inexistencia de relación.</p>
<p>El coeficiente de correlación de Pearson (a veces conocido como coeficiente de correlación a secas) es aplicable para variables cuantitativas que se relacionan de forma lineal. Por otro lado, el coeficiente de correlación de Spearman, es un evaluador de correlación, homólogo en su valor (-1 a +1) al de Pearson, pero con un carácter no paramétrico, lo que implica que la relación entre las variables puede no ser lineal, que no es tan exigente en la existencia de normalidad en la población y aplicable incluso a variables ordinales.</p>
<p>Centrándonos en el coeficiente de correlación de Pearson, dado que tratamos variables cuantitativas, empezamos cargando los datos de volumenes de las parcelas de muestreo, pasando posteriormente a unirlas a la tabla con los estadísticos descriptivos de la nube de puntos de esas parcelas obtenido anteriormente. Para finalizar mostramos las seis variables más relacionadas con la futura variable dependiente.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="r-y-la-información-lidar-forestal.html#cb178-1" aria-hidden="true" tabindex="-1"></a>vcc <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">&quot;data/muestreo.xlsx&quot;</span>)</span>
<span id="cb178-2"><a href="r-y-la-información-lidar-forestal.html#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(vcc)</span>
<span id="cb178-3"><a href="r-y-la-información-lidar-forestal.html#cb178-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-4"><a href="r-y-la-información-lidar-forestal.html#cb178-4" aria-hidden="true" tabindex="-1"></a>vcc <span class="ot">&lt;-</span> <span class="fu">left_join</span>(vcc, stats, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;parc&quot;</span> <span class="ot">=</span> <span class="st">&quot;id&quot;</span>))</span>
<span id="cb178-5"><a href="r-y-la-información-lidar-forestal.html#cb178-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-6"><a href="r-y-la-información-lidar-forestal.html#cb178-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> vcc <span class="sc">%&gt;%</span> </span>
<span id="cb178-7"><a href="r-y-la-información-lidar-forestal.html#cb178-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(geometry, parc, X, Y))<span class="sc">%&gt;%</span></span>
<span id="cb178-8"><a href="r-y-la-información-lidar-forestal.html#cb178-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cor</span>()<span class="sc">%&gt;%</span></span>
<span id="cb178-9"><a href="r-y-la-información-lidar-forestal.html#cb178-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data.frame</span>()<span class="sc">%&gt;%</span></span>
<span id="cb178-10"><a href="r-y-la-información-lidar-forestal.html#cb178-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">add_rownames</span>(<span class="at">var =</span> <span class="st">&quot;lidar_stat&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb178-11"><a href="r-y-la-información-lidar-forestal.html#cb178-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(lidar_stat<span class="sc">!=</span><span class="st">&#39;vcc&#39;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb178-12"><a href="r-y-la-información-lidar-forestal.html#cb178-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">arrange</span>(<span class="fu">desc</span>(vcc))</span>
<span id="cb178-13"><a href="r-y-la-información-lidar-forestal.html#cb178-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-14"><a href="r-y-la-información-lidar-forestal.html#cb178-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-15"><a href="r-y-la-información-lidar-forestal.html#cb178-15" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df, <span class="dv">3</span>)</span>
<span id="cb178-16"><a href="r-y-la-información-lidar-forestal.html#cb178-16" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(df, <span class="dv">3</span>)</span></code></pre></div>
<p>Analizamos la variable dependiente</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="r-y-la-información-lidar-forestal.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skim</span>(vcc<span class="sc">$</span>vcc)</span>
<span id="cb179-2"><a href="r-y-la-información-lidar-forestal.html#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(vcc<span class="sc">$</span>vcc)</span>
<span id="cb179-3"><a href="r-y-la-información-lidar-forestal.html#cb179-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-4"><a href="r-y-la-información-lidar-forestal.html#cb179-4" aria-hidden="true" tabindex="-1"></a>plotn <span class="ot">&lt;-</span> <span class="cf">function</span>(x,<span class="at">main=</span><span class="st">&quot;Histograma de frecuencias </span><span class="sc">\n</span><span class="st">y distribución normal&quot;</span>,</span>
<span id="cb179-5"><a href="r-y-la-información-lidar-forestal.html#cb179-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xlab=</span><span class="st">&quot;X&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Densidad&quot;</span>) {</span>
<span id="cb179-6"><a href="r-y-la-información-lidar-forestal.html#cb179-6" aria-hidden="true" tabindex="-1"></a>  min <span class="ot">&lt;-</span> <span class="fu">min</span>(x)</span>
<span id="cb179-7"><a href="r-y-la-información-lidar-forestal.html#cb179-7" aria-hidden="true" tabindex="-1"></a>  max <span class="ot">&lt;-</span> <span class="fu">max</span>(x)</span>
<span id="cb179-8"><a href="r-y-la-información-lidar-forestal.html#cb179-8" aria-hidden="true" tabindex="-1"></a>  media <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb179-9"><a href="r-y-la-información-lidar-forestal.html#cb179-9" aria-hidden="true" tabindex="-1"></a>  dt <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb179-10"><a href="r-y-la-información-lidar-forestal.html#cb179-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(x,<span class="at">freq=</span>F,<span class="at">main=</span>main,<span class="at">xlab=</span>xlab,<span class="at">ylab=</span>ylab)</span>
<span id="cb179-11"><a href="r-y-la-información-lidar-forestal.html#cb179-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">dnorm</span>(x,media,dt), min, max,<span class="at">add =</span> T,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb179-12"><a href="r-y-la-información-lidar-forestal.html#cb179-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb179-13"><a href="r-y-la-información-lidar-forestal.html#cb179-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-14"><a href="r-y-la-información-lidar-forestal.html#cb179-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plotn</span>(<span class="fu">sqrt</span>(vcc<span class="sc">$</span>vcc))</span></code></pre></div>
<p>Construimos el modelo</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="r-y-la-información-lidar-forestal.html#cb180-1" aria-hidden="true" tabindex="-1"></a>lm<span class="ot">&lt;-</span><span class="fu">lm</span>(vcc<span class="sc">~</span>zq90, <span class="at">data=</span>vcc)</span>
<span id="cb180-2"><a href="r-y-la-información-lidar-forestal.html#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm)</span>
<span id="cb180-3"><a href="r-y-la-información-lidar-forestal.html#cb180-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-4"><a href="r-y-la-información-lidar-forestal.html#cb180-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(vcc<span class="sc">$</span>vcc, <span class="fu">predict</span>(lm))</span>
<span id="cb180-5"><a href="r-y-la-información-lidar-forestal.html#cb180-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb180-6"><a href="r-y-la-información-lidar-forestal.html#cb180-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-7"><a href="r-y-la-información-lidar-forestal.html#cb180-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)) </span>
<span id="cb180-8"><a href="r-y-la-información-lidar-forestal.html#cb180-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm)</span>
<span id="cb180-9"><a href="r-y-la-información-lidar-forestal.html#cb180-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb180-10"><a href="r-y-la-información-lidar-forestal.html#cb180-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-11"><a href="r-y-la-información-lidar-forestal.html#cb180-11" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(lm))</span>
<span id="cb180-12"><a href="r-y-la-información-lidar-forestal.html#cb180-12" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(lm)</span></code></pre></div>
<p>Calculamos los estadísticos de los recintos. El radio de nuestras parcelas es de 9 metros, por lo que la superficie es de 254.469004941 m2 y esto implica una resolución de 15.95208</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="r-y-la-información-lidar-forestal.html#cb181-1" aria-hidden="true" tabindex="-1"></a>pixel <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(pi<span class="sc">*</span><span class="dv">9</span><span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb181-2"><a href="r-y-la-información-lidar-forestal.html#cb181-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-3"><a href="r-y-la-información-lidar-forestal.html#cb181-3" aria-hidden="true" tabindex="-1"></a>metrics <span class="ot">&lt;-</span> <span class="fu">grid_metrics</span>(ctg_norm, .stdmetrics_z, <span class="at">res =</span> pixel)</span>
<span id="cb181-4"><a href="r-y-la-información-lidar-forestal.html#cb181-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-5"><a href="r-y-la-información-lidar-forestal.html#cb181-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(metrics<span class="sc">$</span>zq90)</span>
<span id="cb181-6"><a href="r-y-la-información-lidar-forestal.html#cb181-6" aria-hidden="true" tabindex="-1"></a>vcc_pred <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">899.025+73.630</span><span class="sc">*</span>metrics<span class="sc">$</span>zq90</span>
<span id="cb181-7"><a href="r-y-la-información-lidar-forestal.html#cb181-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(vcc_pred)</span>
<span id="cb181-8"><a href="r-y-la-información-lidar-forestal.html#cb181-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-9"><a href="r-y-la-información-lidar-forestal.html#cb181-9" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(vcc_pred, <span class="fu">paste</span>(dir, <span class="st">&quot;/temp/&quot;</span>, <span class="st">&quot;vcc_pred.tif&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>), <span class="at">datatype=</span><span class="st">&#39;FLT4S&#39;</span>,<span class="at">overwrite =</span> <span class="cn">TRUE</span>, <span class="at">bylayer =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="segmentación-de-árboles" class="section level2" number="2.8">
<h2><span class="header-section-number">2.8</span> Segmentación de árboles</h2>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="r-y-la-información-lidar-forestal.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">opt_output_files</span>(ctg_norm) <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb182-2"><a href="r-y-la-información-lidar-forestal.html#cb182-2" aria-hidden="true" tabindex="-1"></a>ttops <span class="ot">&lt;-</span> <span class="fu">find_trees</span>(ctg_norm, <span class="fu">lmf</span>(<span class="dv">4</span>), <span class="at">uniqueness =</span> <span class="st">&quot;bitmerge&quot;</span>)</span>
<span id="cb182-3"><a href="r-y-la-información-lidar-forestal.html#cb182-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-4"><a href="r-y-la-información-lidar-forestal.html#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="fu">opt_output_files</span>(ctg_norm) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(dir,<span class="st">&quot;/temp/&quot;</span>, <span class="st">&quot;{*}_segmented&quot;</span>)</span>
<span id="cb182-5"><a href="r-y-la-información-lidar-forestal.html#cb182-5" aria-hidden="true" tabindex="-1"></a>segm <span class="ot">&lt;-</span> <span class="fu">dalponte2016</span>(mdv, ttops)</span>
<span id="cb182-6"><a href="r-y-la-información-lidar-forestal.html#cb182-6" aria-hidden="true" tabindex="-1"></a>ctg_segmented <span class="ot">&lt;-</span> <span class="fu">segment_trees</span>(ctg_norm, segm)</span>
<span id="cb182-7"><a href="r-y-la-información-lidar-forestal.html#cb182-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-8"><a href="r-y-la-información-lidar-forestal.html#cb182-8" aria-hidden="true" tabindex="-1"></a><span class="fu">opt_output_files</span>(ctg_segmented) <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb182-9"><a href="r-y-la-información-lidar-forestal.html#cb182-9" aria-hidden="true" tabindex="-1"></a>lasplot <span class="ot">&lt;-</span> <span class="fu">clip_circle</span>(ctg_segmented, <span class="fl">599358.8984</span>,<span class="fl">4734939.2286</span>,  <span class="dv">50</span>)</span>
<span id="cb182-10"><a href="r-y-la-información-lidar-forestal.html#cb182-10" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(lasplot, color = &quot;treeID&quot;, bg = &quot;white&quot;, size = 4)</span></span></code></pre></div>

</div>
</div>
<h3> Referencias</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-R-Zhang2003" class="csl-entry">
Zhang, Keqi, Shu-Ching Chen, D. Whitman, Mei-Ling Shyu, Jianhua Yan, and Chengcui Zhang. 2003. <span>“A Progressive Morphological Filter for Removing Nonground Measurements from Airborne LIDAR Data.”</span> <em>IEEE Transactions on Geoscience and Remote Sensing</em> 41 (4): 872–82. <a href="https://doi.org/10.1109/TGRS.2003.810682">https://doi.org/10.1109/TGRS.2003.810682</a>.
</div>
<div id="ref-R-Zhang2016" class="csl-entry">
Zhang, Wuming, Jianbo Qi, Peng Wan, Hongtao Wang, Donghui Xie, Xiaoyan Wang, and Guangjian Yan. 2016. <span>“An Easy-to-Use Airborne LiDAR Data Filtering Method Based on Cloth Simulation.”</span> <em>Remote Sensing</em> 8 (6). <a href="https://doi.org/10.3390/rs8060501">https://doi.org/10.3390/rs8060501</a>.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>El comando <code>classify_ground</code> no se limita solo a estos dos algoritmos, si no que la librería <code>lidR</code> permite añadir todo aquel algoritmo del que dispongamos fácilmente.<a href="r-y-la-información-lidar-forestal.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>El comando <code>grid_terrain</code> no se limita solo a estos tres algoritmos, si no que la librería <code>lidR</code> permite añadir todo aquel algoritmo del que dispongamos fácilmente.<a href="r-y-la-información-lidar-forestal.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introducción-al-lenguaje-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
